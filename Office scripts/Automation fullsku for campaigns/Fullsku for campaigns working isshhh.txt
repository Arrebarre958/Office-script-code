
function main(workbook: ExcelScript.Workbook) {
    let sheet1 = workbook.getWorksheet("Sheet1");
    let sheet2 = workbook.getWorksheet("Sheet2");
  
    // Declare the ranges explicitly
    let sheet1Range: ExcelScript.Range = sheet1.getRange("A2:A" + sheet1.getUsedRange().getRowCount());
    let sheet2Range: ExcelScript.Range = sheet2.getRange("A2:A" + sheet2.getUsedRange().getRowCount());
  
    // Get values from the ranges, explicitly declaring the types as arrays of arrays of strings
    let sheet1RangeValues: string[][] = sheet1Range.getValues() as string[][];
    let sheet2RangeValues: string[][] = sheet2Range.getValues() as string[][];
  
    // Loop through all values in Sheet1 column A
    sheet1RangeValues.forEach((row, rowIndex) => {
      let matchValue = row[0].slice(0, row[0].length - 4); // Get the base value (exclude the last 4 characters)
      let suffix = row[0].slice(-4); // Get the suffix (last 4 characters)
  
      // Find matching values in Sheet2
      let sheet2Cell = sheet2RangeValues.findIndex((cell) => cell[0] === matchValue);
  
      // If a match is found, insert rows and add suffix in Sheet2
      if (sheet2Cell !== -1) {
        // Determine the row in Sheet2 where the match is found
        let matchRow = sheet2.getRange("A" + (sheet2Cell + 2)); // Row index in Sheet2 (adjusting for 1-based indexing)
  
        // Insert a new row below the match in Sheet2
        let insertRow = sheet2.getRange("A" + (sheet2Cell + 3)); // The row where the new row will be inserted (shift down)
  
        insertRow.getEntireRow().insert(ExcelScript.InsertShiftDirection.down); // Insert a new row below
  
        // Add the base value and the suffix into columns A and B of Sheet2
        sheet2.getRange("A" + (sheet2Cell + 3)).setValue(matchValue);  // Add the match value to column A
        sheet2.getRange("B" + (sheet2Cell + 3)).setValue(suffix);      // Add the suffix to column B
      }
    });
  }
  